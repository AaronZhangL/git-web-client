{% form_theme commit_form 'VersionContolGitControlBundle::FormTheme/_field-prototype.html.twig' %}

{% extends "VersionContolGitControlBundle::layout.html.twig" %}

{% block sidemenu -%}
 {% include 'VersionContolGitControlBundle::Project/sidemenu.html.twig'  %}
{% endblock %}

{% block topcontent %}
    {% include 'VersionContolGitControlBundle::Partials/projectEnvironments.html.twig'  %}
{% endblock %} 

{% block content -%}
    <h1 class="page-header">
       Commit
      <small>
          {{ project.title }} 
      </small>
          {% if (is_granted('MASTER', project)) %}
          <span class="edit"><a href="{{ path('project_edit', { 'id': project.id }) }}">edit</a></span>
        {% endif %}
    </h1>
        <ol class="breadcrumb">
        <li>
            <i class="fa fa-dashboard"></i>  <a href="index.html">Dashboard</a>
        </li>
        <li class="active">
            <i class="fa fa-file"></i> Projects
        </li>
    </ol>

    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title"><i class="fa fa-clock-o fa-fw"></i> Current Branch: {{branchName}}</h3>
        </div>
        <div class="panel-body">
            
            
                        
            {% if(files|length > 0)%}
                {{ form_start(commit_form,{ 'attr': { 'class': 'form'}}) }}
                    {{ form_errors(commit_form) }} 

                    {{ form_label(commit_form.files) }}
                    {{ form_errors(commit_form.files) }}
                    {{ form_widget(commit_form.files,{ 'attr': { 'class': 'form-control'}, 'project':project}) }}
                        
                    <div class="form-group">
                        <button id="commit-select-all" type="button" class="btn btn-default btn-sm" >Select All</button>
                        <button id="commit-deselect-all" type="button" class="btn btn-default btn-sm" >Deselect All</button>
                    </div>
                    <div class="form-group">
                        {{ form_label(commit_form.comment) }}
                        {{ form_errors(commit_form.comment) }}
                        {{ form_widget(commit_form.comment,{ 'attr': { 'class': 'form-control', 'placeholder':'Enter a commit message here'}}) }}
                        <!--<textarea class="form-control" rows="3" name="comment" placeholder="Enter a commit message here" id="commit"></textarea>-->
                    </div>
                    <div class="text-right">
                        <a href="{{ path('home') }}" class="btn btn-default" >Cancel</a>
                        {{ form_widget(commit_form.submit, { 'attr': {'class': ' btn-success submit','data-loading-text':'Committing...'} }) }}
                    </div>
                 
                {{ form_end(commit_form) }}

            {% else %}
                <div class="alert alert-info">There is nothing to commit in this branch</div>
            {% endif %}
        </div>
    </div>
            
    <!-- Modal -->
    <div class="modal fade" id="diff" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-body">Loading...</div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
    <!-- /.modal -->
            

{% endblock %}

 {% block footerJS %}
     <script>
     $(function(){
        $(document).on("hidden.bs.modal", ".modal:not(.local-modal)", function (e) {
            $(e.target).removeData("bs.modal").find(".modal-content").empty().html('<div class="modal-body">Loading...</div>');
        });
     });
     </script>
     
{% endblock %} 
